<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>test_vilmate</title>
	<style>
		.styleDiv {
			min-height: 100px;
			height: 100px;
			width: 100%;
			display: flex;
			justify-content: center;
			align-items: center;
			background-color: azure;
			box-shadow: 0px 0px 30px 5px rgba(177, 177, 241, 0.2);
			cursor: pointer;
		}
	</style>
</head>

<body>
	<script>
		let arrayDivs = [];
		let originalPosition = {};

		for (let i = 0; i < 100; i++) {
			const div = document.createElement('div');
			div.innerText = `Div ${i + 1}`;
			div.classList.add('styleDiv');
			div.dataset.index = i;
			div.addEventListener('click', () => {
				const divId = `DivId ${i}`;
				const currentIndex = arrayDivs.findIndex(el => el.dataset.index == div.dataset.index);

				if (!originalPosition[divId]) {
					originalPosition[divId] = i;
					const elementToMove = arrayDivs.splice(currentIndex, 1)[0];
					arrayDivs.unshift(elementToMove);
				} else {
					const originalIndex = originalPosition[divId];
					const elementToMove = arrayDivs.splice(currentIndex, 1)[0];
					arrayDivs.splice(originalIndex, 0, elementToMove);
					delete originalPosition[divId];
					for (const key in originalPosition) {
						if (originalPosition[key] >= originalIndex) {
							originalPosition[key]++;
						}
					}
				}
				console.log(arrayDivs.map(el => el.innerText), originalPosition);
				updateDom();
			});
			arrayDivs.push(div);
		}

		function updateDom() {
			document.body.innerHTML = '';
			arrayDivs.forEach(div => {
				document.body.appendChild(div);
			});
		}

		updateDom();
	</script>
</body>

</html>